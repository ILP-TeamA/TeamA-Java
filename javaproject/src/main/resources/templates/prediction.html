<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>需要予測</title>
</head>
<body>
<h2>需要予測画面</h2>

<!-- 日付入力 -->
<label>予測日：</label>
<input type="date" id="prediction-date">
<button onclick="runPrediction()">予測する</button>

<hr/>

<!-- 結果表示 -->
<h3>結果：</h3>
<pre id="result"></pre>

<script>
function runPrediction() {
    const date = document.getElementById('prediction-date').value;

    if (!date) {
        alert("日付を選択してください！");
        return;
    }

    // ここで fetch 送信！
    fetch('/api/prediction/run', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ date: date })
    })
    .then(response => {
        if (!response.ok) {
            throw new Error("エラーが発生しました: " + response.statusText);
        }
        return response.json();
    })
    .then(data => {
        console.log(data);
        // 結果を画面に表示
        document.getElementById('result').innerText = JSON.stringify(data, null, 2);
    })
    .catch(error => {
        console.error(error);
        document.getElementById('result').innerText = "エラー: " + error.message;
    });
}
</script>

</body>
</html>
